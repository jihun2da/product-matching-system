# 상품 매칭 시스템 웹앱

RapidFuzz 기반의 고속 상품 매칭 시스템을 웹 인터페이스로 구현한 Flask 애플리케이션입니다.

## 주요 기능

### 🚀 매칭 실행
- **파일 업로드**: 주문서 파일과 기준 데이터 파일을 업로드
- **파일 미리보기**: 업로드한 파일의 데이터를 미리 확인
- **고속 매칭**: 블로킹 알고리즘을 사용한 빠른 매칭 처리
- **결과 다운로드**: 매칭 완료된 Excel 파일 다운로드
- **매칭 통계**: 신뢰도별 매칭 결과 분석

### ⚙️ 설정 관리
- **상품명 동의어**: 상품명에 사용되는 동의어와 약어 관리
- **사이즈 동의어**: 사이즈 표기의 동의어 관리 (예: 2XL → XXL)
- **색상 동의어**: 색상 표기의 정규화 규칙 관리
- **매칭 설정**: 임계값과 가중치 조정
- **엑셀 색상**: 결과 파일의 색상 설정

## 설치 및 실행

### 1. 필요 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. 웹앱 실행

```bash
python app.py
```

웹앱이 `http://localhost:5000`에서 실행됩니다.

## 사용법

### 매칭 실행

1. **파일 업로드**
   - 주문서 파일 (Receipt): 매칭할 주문 데이터
   - 기준 데이터 파일 (Matched): 매칭 기준이 되는 상품 데이터
   - Excel 파일(.xlsx, .xls)만 지원

2. **파일 미리보기** (선택사항)
   - 업로드한 파일의 첫 10행을 미리 확인
   - 데이터 구조와 컬럼명 검증

3. **매칭 실행**
   - 고속 매칭 옵션 선택 (권장)
   - 매칭 진행 상황 실시간 확인
   - 완료 후 결과 통계 확인

4. **결과 다운로드**
   - 주문서 결과 파일: 매칭된 주문 데이터
   - 기준데이터 결과 파일: 색상이 적용된 기준 데이터

### 설정 관리

#### 상품명 동의어
- **표준 용어**: 정규화 후 사용될 표준 용어
- **동의어**: 표준 용어로 변환될 동의어들
- 예시: "맨투맨" ← ["mtm", "맨투맨"]

#### 사이즈 동의어
- 사이즈 표기의 동의어 관리
- 예시: "xxl" ← ["2xl"]

#### 색상 동의어
- 색상 표기의 정규화 규칙
- 예시: "gray" → "회색", "그레이" → "회색"

#### 매칭 설정
- **상품명 매칭 임계값**: 퍼지 매칭의 최소 점수 (0-100)
- **가중치**: 각 속성의 중요도 (합계 1.0)
  - 브랜드: 0.25
  - 상품명: 0.35
  - 색상: 0.25
  - 사이즈: 0.15

#### 엑셀 색상
- 매칭 결과 파일의 색상 설정
- ARGB 8자리 HEX 코드 사용
- 예시: "00FFFF00" (노랑색)

## 파일 구조

```
├── app.py                 # Flask 메인 애플리케이션
├── config.py              # 설정 파일
├── match.py               # 매칭 엔진
├── requirements.txt       # 패키지 의존성
├── templates/             # HTML 템플릿
│   ├── base.html         # 기본 레이아웃
│   ├── index.html        # 메인 페이지
│   └── config.html       # 설정 페이지
├── static/               # 정적 파일
│   ├── css/
│   │   └── style.css     # 스타일시트
│   └── js/
│       ├── main.js       # 메인 페이지 스크립트
│       └── config.js     # 설정 페이지 스크립트
├── uploads/              # 업로드 파일 저장소
└── outputs/              # 결과 파일 저장소
```

## API 엔드포인트

### 파일 처리
- `POST /api/upload` - 파일 업로드
- `POST /api/preview` - 파일 미리보기
- `POST /api/process` - 매칭 실행
- `GET /api/download/<filename>` - 결과 파일 다운로드

### 설정 관리
- `GET /api/config` - 현재 설정 조회
- `POST /api/config` - 설정 업데이트

## 매칭 알고리즘

### 고속 매칭 (권장)
- **블로킹**: 브랜드, 색상, 사이즈 기준으로 후보군 제한
- **벡터화**: RapidFuzz의 process.extract 활용
- **조기 종료**: 불가능한 매칭 조기 차단

### 표준 매칭
- 모든 조합을 순차적으로 검사
- 소규모 데이터셋에 적합

### 매칭 기준
1. **브랜드**: 정확히 일치해야 함
2. **색상**: 정확히 일치해야 함  
3. **사이즈**: 교집합이 있어야 함
4. **상품명**: 퍼지 매칭 (임계값 이상)

## 주의사항

- Excel 파일의 컬럼명이 정확해야 합니다:
  - 필수 컬럼: 브랜드, 상품명, 색상, 사이즈, 수량
- 파일 크기는 최대 16MB까지 지원합니다.
- 매칭 결과는 신뢰도 순으로 정렬됩니다.
- 설정 변경 시 반드시 저장 버튼을 클릭해주세요.

## 문제 해결

### 매칭이 안 되는 경우
1. 브랜드명이 정확히 일치하는지 확인
2. 색상 동의어 설정 확인
3. 사이즈 표기 동의어 확인
4. 상품명 매칭 임계값 조정

### 성능 최적화
1. 고속 매칭 옵션 사용
2. 불필요한 동의어 제거
3. 매칭 임계값 적절히 조정

## 라이선스

이 프로젝트는 MIT 라이선스를 따릅니다. 